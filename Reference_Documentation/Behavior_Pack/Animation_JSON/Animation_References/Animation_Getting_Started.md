# Документация по анимации - Начало работы

## Обзор анимации в Minecraft: Bedrock Edition

Анимация следует текущим парадигмам Minecraft JSON:

+ Поля должны быть в нижнем регистре и использовать символы подчеркивания (без пробелов).
+ Все файлы JSON в определенном каталоге и поддереве будут прочитаны и интерпретированы системой анимации.

## Добавление анимации

Прежде чем перейти к рассмотрению того, как анимация определяется в аддонах, давайте рассмотрим пример файла определения
сущности, который демонстрирует, как анимация назначается сущности.

### Пример определения сущности

``` json
{
  "format_version": "1.10.0",
  "minecraft:client_entity": {
    "description": {
      "identifier": "minecraft:pig",
      "min_engine_version": "1.8.0",
      "materials": { "default": "pig" },
      "textures": {
        "default": "textures/entity/pig/pig",
        "saddled": "textures/entity/pig/pig_saddle"
      },
      "geometry": {
        "default": "geometry.pig.v1.8"
      },
      "animations": {
        "setup": "animation.pig.setup",
        "walk": "animation.quadruped.walk",
        "look_at_target": "animation.common.look_at_target",
        "baby_transform": "animation.pig.baby_transform"
      },
      "scripts": {
        "animate": [
          "setup",
          { "walk": "query.modified_move_speed" },
          "look_at_target",
          { "baby_transform": "query.is_baby" }
        ]
      },
      "render_controllers": [ "controller.render.pig" ],
      "spawn_egg": {
        "texture": "spawn_egg",
        "texture_index": 2
      }
    }
  }
}
```

Это означает, что вы не увидите анимацию движения в файле анимации pig.json. Если вы хотите создать собственную анимацию
ходьбы свиньи, вы можете изменить эту строку, чтобы она указывала на вашу собственную анимацию.

Анимации указываются в виде короткого имени, за которым следует полное имя ресурса. Короткое имя используется в
контроллерах анимации и в списке `scripts/animate`, а длинное имя - в файле анимации.

В разделе `scripts/animate` вы перечисляете анимации, которые должны воспроизводиться и в каком порядке. Вы можете либо
указать анимацию напрямую, либо указать выражение смешивания.

## Контроллер анимации

Хотя многое из этого может управляться в разделе определения сущности `scripts/animate`, контроллеры анимации позволяют
разделить машину состояний на состояния и управлять ими как блоком. Анимации в состоянии контроллера анимации могут быть
сами контроллерами анимации, что позволяет создавать произвольно сложные иерархии анимаций.

### Пример контроллера анимации

``` json
{
  "format_version": "1.10.0",
  "animation_controllers": {
    "controller.animation.my_mob.move": {
      "initial_state": "moving",
      "states": {
        "moving": {
          "animations": [
            "wag_tail",
            "wiggle_ears",
            { "walk": "query.modified_move_speed" }
          ],
          "transitions": [
            { "grazing": "query.is_grazing" }
          ]
        },
        "grazing": {
          "animations": [ "grazing" ],
          "transitions": [
            { "moving": "query.all_animations_finished" }
          ]
        }
      }
    }
  }
}
```

Чтобы узнать больше о контроллерах анимации, посетите справочную
страницу [Контроллеры анимации](Animation_Animation_Controllers.md).

## Animations

Please note that the channels (x, y, and z) are added separately across animations first! After, they are then converted
to a transform once all animations have been cumulatively applied.

Animation data can be either raw data:

``` json
"rotation": [90.0, 0.0, 0.0]
```

or a run-time interpreted script:

``` json
"rotation": ["cos(query.anim_pos * 38.17) * 80.0 * query.anim_speed", 0.0, 0.0]
```

> Примечание
>
> По умолчанию вращения задаются в градусах, в формате Эйлера X-then-Y-then-Z.

### Пример из файла quadruped.animation.json в папке animation ванильного пакета ресурсов

``` json
{
  "format_version": "1.8.0",
  "animations": {
    "animation.quadruped.walk": {
      "anim_time_update": "query.modified_distance_moved",
      "loop": true,
      "bones": {
        "leg0": { "rotation": [ "Math.cos(query.anim_time * 38.17) *  80.0", 0.0, 0.0 ] },
        "leg1": { "rotation": [ "Math.cos(query.anim_time * 38.17) * -80.0", 0.0, 0.0 ] },
        "leg2": { "rotation": [ "Math.cos(query.anim_time * 38.17) * -80.0", 0.0, 0.0 ] },
        "leg3": { "rotation": [ "Math.cos(query.anim_time * 38.17) *  80.0", 0.0, 0.0 ] }
      }
    }
  }
}
```

## Названия

Все названия: анимации, кости, состояния и т.д. должны начинаться с буквы и содержать только буквенно-цифровые символы,
подчеркивание или точку. Рекомендуется использовать имена в нижнем регистре.

В примерах ключевых кадров ниже, `head` и используется как имя кости.

## Ключевые кадры

Ключевой кадр определяет два значения для преобразования конкретного канала к конкретной кости в определенное время,
одно - по мере приближения к времени ключевого кадра, а второе - начиная с этого ключевого кадра. Таким образом, при
интерполяции между двумя ключевыми кадрами можно определить наклон кривой анимации непрерывным или прерывистым способом.

> Примечание
>
> Интерполяция в сценарии анимации используется для расчета движения между двумя ключевыми кадрами.
>
> > Если ключевой кадр установлен на первом кадре со значением 0, а ключевой кадр установлен на десятом кадре со значением 1, то кадры между ними будут интерполированы, чтобы плавно перемещать значение от 0 до 1 на каждом кадре, пока оно не достигнет кадра 10.

### Непрерывный пример

``` json
"head": {
  "rotation": {
    "0.0":[0, 0, 0],
    "0.5": [ 0, 180, 0],
    "1.0": [0, 360, 0]
  }
}
```

## Прерывистый пример

В этом примере масштабируется кость "голова":

    От 0 до 0,5 секунды (в теге "pre"), кость головы устанавливается на свой нормальный масштаб 1 во всех измерениях [X, Y, Z].
    В 0,5 секунды кость мгновенно масштабируется до 2-кратного нормального размера.
    От 0,5 до 1 секунды ("пост"), кость вернется к своему нормальному размеру 1 во всех измерениях.

> Примечание
>
> В приведенном выше примере формата файла, "pre" и "post" также могут быть определены выражением Molang, которое вычисляет это значение во время выполнения, позволяя вам иметь математически определенную кривую вместо чисто линейной.

``` json
"head": {
  "scale": {
    "0.5": {
      "pre": [1, 1, 1],
      "post": 2.0
    }
    "1.0": [ 1.0 ]
  }
}
```

## Трансформации

Трансформации в анимации состоят из трех компонентов: расположение в трехмерном пространстве, вращение и масштабе.

Следует помнить о некоторых ключевых моментах работы трансформаций в Bedrock:

+ Порядок операций: вершины переводятся, поворачиваются, затем масштабируются.
+ Данные анимации предполагаются иерархическими и применяются к кости путем сопоставления имени кости в данных анимации со скелетом целевой геометрии.
+ Не каждая кость должна быть анимирована.
+ Можно анимировать кости, которые не существуют в целевой геометрии (отсутствующие кости игнорируются).
+ Для каждого из полей scale, rotation, position можно задать индивидуально или единообразно одно значение. Например, это эквивалентно:
