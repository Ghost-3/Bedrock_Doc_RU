# Команды - Как сделать карту "Complete the Monument"

Теперь пришло время создать полную систему команд: обнаружение завершения строительства монумента для короткой карты "
Complete the Monument".

В этом руководстве вы узнаете следующее:

+ Как применить полученные знания о командах для создания простой системы команд, используя некоторые популярные
  команды.

### Требования

Перед началом этого урока рекомендуется пройти следующее.

+ [Введение в команды](Introduction_to_Commands.md)
+ [Начало работы с командными блоками](Getting_Started_with_Command_Blocks.md)
+ [Популярные команды](Popular_Commands.md)

## Установка

Незавершенный монумент должен быть построен в статичном месте. Три пустых места перед витражом указывают на то, куда
игрок должен поместить шерсть, когда соберет ее. Координаты этих пустых мест используются для обнаружения.

![monument.png](https://docs.microsoft.com/ru-ru/minecraft/creator/documents/media/commands/monument.png)

Необходимо создать цель табло, чтобы молча отслеживать, какие цвета шерсти были размещены. Эта информация должна
храниться, чтобы игрок не смог просто сломать один из блоков шерсти и положить его обратно, чтобы обмануть и заработать
больше наград.

```
/scoreboard objectives add wool_placed dummy
```

Еще одна цель необходима для хранения общего количества размещенной шерсти, не конфликтуя с другими оценками, о чем
будет рассказано позже.

```
/scoreboard objectives add totals dummy
```

Эта информация также не может храниться по каждому игроку, поскольку несколько игроков могут играть в разное время,
поэтому вместо нее будут использоваться "фальшивые" игроки. Фальшивый игрок - это просто имя игрока, которого не
существует в мире (и, следовательно, он не может быть выбран селекторами целей). Команда `/scoreboard` не выдает ошибку,
если такой игрок не найден. Предварительное добавление к имени хэша (#) предотвратит появление фальшивого игрока в
списке результатов на боковой панели.

```
/scoreboard players set #red wool_placed 0
/scoreboard players set #green wool_placed 0
/scoreboard players set #blue wool_placed 0

/scoreboard players set #total_wool totals 0
```

Поскольку будут использоваться повторяющиеся командные блоки, чат будет переполнен выводом командных блоков. Это можно
отключить с помощью геймерула "commandblockoutput".

```
/gamerule commandblockoutput false
```

Кроме того, когда игрок получает алмазы в качестве награды, в чате появится общее сообщение о том, что ему дали
предметы. При желании это можно отключить, но имейте в виду, что некоторое сообщение о награде может быть полезным для
игрока.

```
/gamerule sendcommandfeedback false
```

## Награда за размещение отдельных шерстяных блоков

Каждый из следующих наборов команд будет размещаться в своих собственных цепочках, являясь копией того, что показано на
изображении ниже для каждой отдельной цепочки. Отдельные цепочки очень похожи друг на друга, но каждая из них специально
обнаруживает шерсть нужного цвета в ожидаемом месте. Обратите внимание, что все командные блоки цепочки установлены на
условное значение.

![monumentrewardonce.png](https://docs.microsoft.com/ru-ru/minecraft/creator/documents/media/commands/monumentrewardonce.png)

### Обнаружение красной шерсти

1. Команда `/testforblock` проверяет наличие красной шерсти в предполагаемых координатах в монументе.
2. Если предыдущая команда успешно нашла блок шерсти, команда `/scoreboard` проверит счет подставного игрока "#red".
   Если счет равен 0, это означает, что красная шерсть не была размещена ранее.
3. Поскольку красную шерсть еще предстояло разместить, игрок получит алмаз за то, что он это сделал.
4. И, наконец, счет "#red" будет равен 1, что означает, что красная шерсть теперь размещена.

Не забудьте заменить `X Y Z` на координаты места, куда будет помещена шерсть в вашем собственном мире.

```
/testforblock X Y Z шерсть 14
/scoreboard players test #red wool_placed 0 0
/give @a diamond
/scoreboard players set #red wool_placed 1
```

### Обнаружение зеленой шерсти

Происходит точно такой же процесс, как и с красной шерстью, только на этот раз команды специфичны для зеленой шерсти.

```
/testforblock X Y Z wool 13
/scoreboard players test #green wool_placed 0 0
/give @a diamond
/scoreboard players set #green wool_placed 1
```

### Обнаружение синей шерсти

Происходит точно такой же процесс, как и с красной шерстью, только на этот раз команды специфичны для синей шерсти.

```
/testforblock X Y Z wool 11
/scoreboard players test #blue wool_placed 0 0
/give @a diamond
/scoreboard players set #blue wool_placed 1
```

## Награда за завершение монумента

После завершения строительства памятника игрок получает в награду стопку алмазов. В этом случае можно использовать
некоторые простые математические вычисления, чтобы определить, все ли шерстинки были расставлены. Поскольку после
обнаружения шерсти каждый из подставных игроков получает 1 балл, если сумма баллов всех подставных игроков равна 3,
значит, все шерсти были расставлены. Оператор табло "+=" может помочь в получении суммы очков.

![monumentrewardcomplete.png](https://docs.microsoft.com/ru-ru/minecraft/creator/documents/media/commands/monumentrewardcomplete.png)

1. У поддельного игрока с именем "#total_wool" сначала установлено значение 0. Поскольку оператор `+=` прибавляет один
   результат к другому, с каждым тиком счет будет увеличиваться все больше и больше. Установив сначала 0, мы получим
   точную сумму.
2. Оператор += используется для суммирования оценок всех игроков в задаче "wool_placed" (обозначается звездочкой *), и
   результат сохраняется как оценка поддельного игрока "#total_wool" в задаче "totals". Если бы это была одна и та же
   цель, то значение "#total_wool" могло бы быть добавлено после того, как к нему были бы добавлены другие оценки, что
   дало бы неверный результат.
3. Значение "#total_wool" проверяется, чтобы узнать, равно ли оно ровно 3. Если да, это означает, что все шерстинки были
   размещены.
4. Если счет был равен 3, все игроки получат стопку бубнов.
5. Команда нужна для того, чтобы цепочка командных блоков не прерывалась постоянно, так как сумма всегда будет
   одинаковой каждый тик. Если установить показатель любого цвета шерсти больше 1, то сумма будет больше 3, что не
   позволит системе наводнить инвентарь игрока алмазами. Существует множество других способов сделать это, включая
   отключение цепочки командных блоков каким-либо образом.

```
/scoreboard players set ##total_wool totals 0
/scoreboard players operation ##total_wool totals += * wool_placed
/scoreboard players test ##total_wool totals 3 3
/give @a diamond 64
/табло игроков набор #красная шерсть_размещено 2
```

### Что дальше?

Теперь, когда вы освоили командные системы, смешивание их с поведенческими пакетами может значительно увеличить
взаимодействие между игроками и вашим пользовательским контентом. Следующим шагом будет изучение поведенческих пакетов.

[Введение в наборы параметров](../Adding_Content/Introduction_to_Behavior_Packs.md)
