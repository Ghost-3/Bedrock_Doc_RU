# Начало работы с командными блоками

Командные блоки - это специализированный тип блоков в мире Minecraft: Bedrock Edition, который позволяет использовать
консольные команды в игре. Те же команды, которые игроки могут набирать в чате, могут автоматически выполняться
командными блоками, использующими энергию красного камня.

В этом руководстве вы узнаете следующее;

+ Что такое командные блоки и как получить к ним доступ в игре.
+ Как можно использовать команды с помощью командных блоков.
+ Как работают цепочки командных блоков, объединяющие несколько командных блоков.
+ Создание игрового цикла для вознаграждения игрока после выполнения действия.

В этом руководстве мы настроим цепочку командных блоков для поиска определенного типа блоков в заданном месте, а затем
вознаградим игрока за размещение блока в нужном месте.

### Требования

+ Мир Minecraft с включенными читами.

#### Настройка карты

Хотя командные блоки можно использовать в любом мире Minecraft, мы будем использовать плоский мир для создания простой и
чистой среды.

1. Запуск Minecraft: Bedrock Edition.
2. Выберите **Играть**, выберите **Создать**, затем выберите **Создать новый мир**.
3. В настройках мира установите тип мира **Плоский**.
4. В настройках мира включите опцию **Показать координаты**.
5. В настройках мира включите **Читы**.
6. Выберите **Создать**.

### Как получить командный блок

Командные блоки можно получить, только выполнив команду.

1. Откройте чат.
2. Введите следующую команду: `/give @p command_block`.

Вы увидите один командный блок, который был добавлен в ваш инвентарь.

## Как использовать командные блоки

Сначала положите командный блок на землю, как любой другой блок. Посмотрите на командный блок сбоку, и вы можете
заметить стрелку.

![commandblockarrows.png](https://docs.microsoft.com/ru-ru/minecraft/creator/documents/media/commandblocks/commandblockarrows.png)

Эти стрелки всегда будут направлены в сторону игрока при размещении вниз. Стрелки показывают поток выполнения. Как
показано на рисунке, сначала будет выполнен блок слева, затем средний командный блок, и, наконец, последний блок справа.

Нажмите кнопку **Использовать** (правая кнопка мыши на ПК), чтобы открыть пользовательский интерфейс командного блока.

## Пользовательский интерфейс командного блока

![commandblockgui.png](https://docs.microsoft.com/ru-ru/minecraft/creator/documents/media/commandblocks/commandblockgui.png)

+ **Тип блока** определяет тип командного блока. Существует 3 варианта:
    - **Импульсные** командные блоки активируются при получении сигнала красного камня.
    - **Цепные** командные блоки активируются, когда активируется командный блок, указывающий на него.
    - **Цикличные** командные блоки активируются раз в игровые тики, пока у них есть сигнал красного камня. В Minecraft
      20 тиков в секунду.
+ **Условность** определяет, когда командный блок будет выполнять свое действие. Есть 2 варианта:
    - **Условный** будет выполняться только в том случае, если предыдущий блок в цепочке был успешным.
    - **Безусловный** будет выполняться независимо от того, был ли предыдущий блок успешным или нет.
+ **Красный камень** определяет, требуется ли командному блоку красный камень для активации. Есть 2 варианта:
    - **Требуется** красный камень - командный блок активируется только при наличии красного камня.
    - **Всегда активен** - командный блок будет активироваться всегда, с красным камнем или без него. Для импульсных
      командных блоков этот параметр активирует их только один раз, поэтому он не очень полезен. Для командных блоков
      цепочки это включено по умолчанию.
+ **Execute on First Tick** (Выполнить при первом тике) можно использовать только для повторяющихся командных блоков с
  задержкой. Если включено, команда будет выполнена, как только блок будет включен, а затем будет ждать задержки перед
  повторным запуском. Если отключено, команда не будет выполняться в первый раз, пока не закончится задержка.
+ **Задержка в тиках** - это значение, определяющее, как долго командный блок ожидает выполнения после получения питания
  от редстоуна.

## Создание игрового цикла

Одним из вариантов использования командных блоков является возможность создания циклов игрового процесса в Minecraft.
Простым игровым циклом может быть вознаграждение игрока за выполнение какого-либо действия. Если в цикле геймплея игрок
должен получить изумруд за размещение алмазного блока в определенном месте, вы можете разбить каждый необходимый шаг:

1. Проверить, существует ли алмазный блок в заданном месте.
2. Если он существует, проверьте, получил ли игрок награду.
3. Если игрок не получил награду, дайте ему изумруд.
4. Отдав игроку изумруд, отметьте, что он получил награду.

### Настройка первого командного блока

Теперь, когда мы рассмотрели настройки командного блока, давайте настроим первый блок на обнаружение определенного типа
блоков в определенном месте.

1. Поместите командный блок на землю в месте рядом с персонажем игрока.
2. Откройте интерфейс командного блока.
3. Установите **Тип блока** на **Цикличный**.
4. Установите **Красный камень** в значение **Всегда активен**.

#### Команда `/testforblock`.

Команда `/testforblock` ищет определенный блок в заданной точке мира.

`/testforblock <позиция: x y z> <tileName: Блок> [dataValue: int]`.

+ **position** - это координаты в мире, где команда будет искать определенный блок. Пример: `0 4 0`.
+ **tileName** - это тип блока, который вы ищете. Пример: `алмазный_блок`.
+ **dataValue** - необязательный аргумент, используемый для обработки вариаций одного и того же блока. В этом учебнике
  он нам не понадобится.

Если вы будете следовать этому руководству, вы окажетесь в плоском мире. Когда вы ходите по нему, вы можете видеть
положение вашего игрока в левом верхнем углу экрана. Давайте проверим наличие блока вблизи начала координат.

1. В разделе ввода команд введите следующее: `/testforblock 0 4 0 diamond_block`.
2. Закройте интерфейс.

## Цепочки командных блоков

Для следующего шага нам нужно разместить командный блок цепочки. Как упоминалось выше, цепные командные блоки
выполняются, когда активируется блок, указывающий на них. Убедитесь, что вы разместили блок так, как показано на рисунке
со стрелками.

### Установка командного блока `/testforblock`.

1. Поместите еще один командный блок рядом с существующим блоком. Убедитесь, что новый блок расположен напротив
   направления, на которое указывает стрелка.
2. Откройте интерфейс командного блока.
3. Установите **Тип блока** на **Цепной**.
4. Установите **Условие** на **Условный**.
5. Установите **Красный камень** на **Всегда активен**.
6. Установите **Ввод команд** в `/testfor @p[tag=!placed_block]`.

Поскольку второй блок **Условный**, этот новый блок будет выполняться только в случае успеха первого командного блока,
что означает, что алмазный блок присутствовал. Эта команда проверяет, не получил ли игрок еще награду.

### Установка командного блока вознаграждения

Добавим третий блок, чтобы задать команду, вознаграждающую игрока за размещение блока в нужном месте.

1. Поместите еще один командный блок рядом с существующим блоком. Убедитесь, что новый блок расположен напротив
   направления, на которое указывает стрелка.
2. Откройте интерфейс командного блока.
3. Установите для параметра **Тип блока** значение **Цепной**.
4. Установите **Условие** на **Условный**.
5. Установите **Красный камень** на **Всегда активен**.
6. Введите команду `/give @p emerald`.

И снова эта команда активируется только в том случае, если предыдущая команда прошла успешно, то есть и алмазный блок
присутствовал, и игрок еще не получил награду.

### Замыкание цикла

Если мы остановимся сейчас, то размещение алмазного блока по адресу `0 4 0` даст игроку 20 изумрудов в секунду! Это
потому, что нам нужно сделать последний шаг - пометить игрока как получившего награду.

1. Поместите еще один командный блок рядом с существующим блоком. Убедитесь, что новый блок расположен напротив того
   направления, куда указывает стрелка.
2. Откройте интерфейс командного блока.
3. Установите для параметра **Тип блока** значение **Цепной**.
4. Установите **Условие** на **Условный**.
5. Установите **Красный камень** на **Всегда активен**.
6. Установите командный вход `/tag @p add placed_block`.

### Тестирование цикла

Если все было настроено правильно, теперь вы можете поместить алмазный блок на локацию 0, 4, 0 и получить один изумруд в
инвентарь игрока.