# Введение в наборы параметров

Перед созданием первого дополнения вам нужно будет создать пакет, чтобы добавить любой пользовательский контент в
Minecraft: Bedrock Edition. Существует два типа пакетов, которые может создать создатель: пакеты ресурсов и пакеты
поведения. В этом уроке мы рассмотрим, как создаются пакеты поведения и как добавить серию атакующих моделей поведения к
мобу коровы в игре.

В этом руководстве вы узнаете следующее:

+ Зависимость между пакетами ресурсов и пакетами поведения.
+ Что такое компоненты и как они используются для определения мобов Minecraft.
+ Как добавить поведение к существующему мобу.

### Требования

Перед началом данного руководства рекомендуется завершить изучение следующих разделов.

+ [Начало разработки дополнений](Getting_Started.md)
+ [Введение в наборы ресурсов](Introduction_to_Resource_Packs.md)
+ Загрузите [Vanilla Behavior Pack](https://aka.ms/behaviorpacktemplate)

## Создание пакета параметров

Пакет параметров - это тип пакета, который позволяет создателям добавлять, удалять или изменять игровое поведение
сущностей в Minecraft: Bedrock Edition. В файлах этих сущностей поведение - это то, что заставляет каждую сущность
выполнять определенные действия, например, стая цыплят следует за пером или зомби нападает на игрока или другую
сущность.

Параметры дают создателям возможность изменять то, как сущности могут действовать в мире. В этом разделе вы создадите
папку для нового пакета Behavior Pack под названием **HelloWorldBP**.

1. Откройте папку с расположением игры **com.mojang**.
2. Дважды щелкните на папке **development_behavior_packs**.
3. Щелкните правой кнопкой мыши в окне Проводника и выберите **Создать**, а затем **Папку**, чтобы создать новую папку.
4. Назовите новую папку **HelloWorldBP**.
5. Дважды щелкните на **HelloWorldBP**, чтобы открыть папку.

![helloworldbp.png](https://docs.microsoft.com/ru-ru/minecraft/creator/documents/media/behaviorpack/helloworldbp.png)

### Файл манифеста

Чтобы загрузить поведенческий пакет в Minecraft, необходимо создать файл манифеста. Файл манифеста похож на тот, что
создается для Пакетов Ресурсов, но в нем есть новый раздел, который необходимо добавить.

1. Щелкните правой кнопкой мыши в окне Проводника и выберите **Создать**, затем выберите **Текстовый документ**.
2. Задайте имя **manifest.json**.
    * Вам нужно будет изменить расширение файла с .txt на .json. Если в окне Проводника не отображаются расширения
      файлов, вы можете включить **Расширения имен файлов** на вкладке **Вид**.
      ![manifest_filebp.png](https://docs.microsoft.com/ru-ru/minecraft/creator/documents/media/behaviorpack/manifest_filebp.png)
3. Дважды щелкните на файле **manifest.json**, чтобы открыть его в текстовом редакторе.
4. Скопируйте/вставьте следующий фрагмент кода в текстовый редактор.

``` json
{
  "format_version": 2,
  "header": {
    "description": "My First Add-On!",
    "name": "HelloWorldBP",
    "uuid":"",
    "version": [1, 0, 0],
    "min_engine_version": [1, 16, 0]
  },
  "modules": [
    {
      "description": "My First Add-On!",
      "type": "data",
      "uuid": "",
      "version": [1, 0, 0]
    }
  ]
}
```

> **Примечание**
>
> Для `format_version`, `2` используется в качестве значения для файла manifest.json. Хотя `"1.16.0"` или `[1.16.0]` используются в ванильных файлах манифеста, рекомендуется использовать последнюю `"format_version": 2` для пользовательского содержимого.

### UUID

Как и в файле манифеста ресурспака, для загрузки пакета в Minecraft необходимо сгенерировать ряд UUID. Для заголовка и
модулей необходимо ввести 2 разных номера UUID между кавычками. Вы можете использовать онлайн-генератор UUID,
например, [UUID Generator](https://www.uuidgenerator.net/).

![%5CMedia%5CBehaviorPack%5CUUID.png](https://docs.microsoft.com/ru-ru/minecraft/creator/documents/%5CMedia%5CBehaviorPack%5CUUID.png)

1. Скопируйте и вставьте UUID в раздел заголовка. Для правильного восприятия UUID необходимо вставить между
   кавычками ("").
2. Перезагрузите веб-страницу, чтобы сгенерировать новый UUID для использования в разделе "Модули".
3. Скопируйте и вставьте новый UUID в раздел модулей между кавычками.
4. Сохраните файл манифеста.

### Зависимости

Для поведенческого пакета можно добавить третью секцию в файл manifest.json под названием Dependencies. Зависимость
создает связь между поведенческим пакетом и пакетом ресурсов через UUID, расположенный в разделе заголовка
манифеста.json пакета ресурсов. Добавьте зависимость для ранее созданного вами пакета ресурсов helloWorldRP и настройте
его на автоматическую активацию при активации пакета поведения.

Ниже приведен пример того, как будет выглядеть готовый файл манифеста пакета параметров.

``` json
{
  "format_version": 2,
  "header": {
    "description": "My First Add-On!",
    "name": "Hello WorldBP",
    "uuid":"",
    "version": [1, 0, 0],
    "min_engine_version": [1, 16, 0]
  },
  "modules":
    [
      {
        "description": "My First Add-On!",
          "type": "data",
          "uuid": "",
          "version": [1, 0, 0]
      },
    ],
  "dependencies": [
    {
      "uuid":"<Insert the UUID from HelloWorldRP>",
      "version":[1,0,0]
    }
 ]
}
```

1. В примере, показанном выше, скопируйте раздел зависимостей.
2. Вставьте раздел зависимостей под разделом модулей. Используйте приведенный выше пример в качестве справочника.
    * Обратите внимание на форматирование JSON, приведенное выше.
3. Скопируйте и вставьте UUID из раздела **header** в файле **manifest.json**, расположенном в папке **HelloWorldRP**, в
   раздел Dependencies.
4. Добавьте запятую после закрывающей скобки, расположенной над зависимостями.

## Сущность

Поведение каждого персонажа определяется с помощью json-файла. В этом разделе вы скопируете файл cow.json, расположенный
в стандартном ванильном пакете Behavior Pack.

1. В папке **HelloWorldBP** щелкните правой кнопкой мыши в окне Проводника и выберите **Создать**, а затем **Папку**,
   чтобы создать новую папку.
2. Назовите папку **entities**.
3. Убедитесь, что вы скачали Vanilla Behavior Pack, расположенный в разделе "Требования" этого руководства.
4. Распакуйте папку, чтобы получить доступ к содержащимся в ней файлам.
5. Перейдите в папку **entities**, расположенную в распакованном пакете.
6. Скопируйте файл **cow.json** и вставьте его в папку **HelloWorldBP/entities**.

Теперь, имея копию файла cow.json, расположенного в HelloWordBP, вы можете вносить изменения и редактировать поведение
существующего моба коровы. Cow.json, как и другие json-файлы сущностей Minecraft, можно разбить на ряд секций.

### minecraft:entity

Первый раздел - это `minecraft:entity`. Этот контейнер используется для определения сущности. Описание, группы
компонентов, компоненты и события содержатся в объекте `minecraft:entity`. В файле cow.json вы можете увидеть следующий
набор для описания:

``` json
"minecraft:entity": {
    "description": {
      "identifier": "minecraft:cow",
      "is_spawnable": true,
      "is_summonable": true,
      "is_experimental": false
    },
```

+ `identifier` - это внутриигровое имя, используемое для определения сущности.
+ `is_spawnable` - булево значение (True/False), позволяющее сущности быть порожденной в мире.
+ `is_summonable` - булево значение, позволяющее игрокам вызывать сущность через командный интерфейс.
+ `is_experimental` - булево значение, отмечающее, находится ли сущность в экспериментальном состоянии.

### Группы компонентов

Группы компонентов используются для организации и определения набора параметров поведения сущности. Группы компонентов
позволяют варьировать поведение для схожих типов мобов, например, создать взрослую и детскую версии одной сущности моба.
В файле cow.json есть 2 группы: `"minecraft:cow_baby"` и `"minecraft:cow_adult"`. Ниже показана группа компонента
cow_baby.

``` json
"component_groups": {
      "minecraft:cow_baby": {
        "minecraft:is_baby": {
        },
        "minecraft:scale": {
          "value":0.5
        },
        "minecraft:ageable": {
          "duration": 1200,
          "feed_items": "wheat",
          "grow_up": {
            "event": "minecraft:ageable_grow_up",
            "target": "self"
          }
        },

        "minecraft:behavior.follow_parent": {
          "priority": 6,
          "speed_multiplier": 1.1
        }
      },
```

В примере cow.json, показанном выше, видно, что `"minecraft:cow_baby"` имеет под собой специальные компоненты,
контролирующие размер, способность к старению и возможность следовать за чем-то, помеченным как родитель.

### Компоненты

Компоненты определяют параметры и свойства, которые вы можете назначить сущности, чтобы адаптировать их поведение.

``` json
"components": {
      "minecraft:type_family": {
        "family": [ "cow", "mob" ]
      },
      "minecraft:breathable": {
        "total_supply": 15,
        "suffocate_time": 0
      },
```

В файле cow.json можно увидеть, что первые два компонента - это `"minecraft:type_family"` и `"minecraft:breathable"`.
Эти компоненты задают, к какой категории семейства относится корова и как хорошо она может задерживать дыхание под
водой, прежде чем получит урон. Это глобальные настройки, которые применяются к любому объекту minecraft:cow, независимо
от того, ребенок это или взрослый.

### События

События - это действия, которые вы можете предпринять в отношении сущности, когда поведение сущности вызывает особое
событие.

``` json
"events": {
      "minecraft:entity_spawned": {
        "randomize": [
          {
            "weight": 95,
            "add": {
              "component_groups": [
                "minecraft:cow_adult"
              ]
            }
          },
          {
            "weight": 5,
            "add": {
              "component_groups": [
                "minecraft:cow_baby"
              ]
            }
          }
        ]
    },
```

В файле cow.json, показанном выше, событие entity_spawned определено здесь для того, чтобы породить в мире либо взрослую
корову, либо детеныша коровы.

+ `randomize` позволяет определить вероятность того, что сущность породится в любой группе. Здесь существует вероятность
  95/100 породить взрослую корову или вероятность 5/100 породить детеныша коровы. Обратите внимание, что randomize не
  работает на основе процентной системы. Вместо этого шансы рассчитываются через сумму определения "веса". Если бы вы
  изменили "вес": 5 на "вес":25, то вероятность нереста составит 25/120.

## Добавление новых параметров

Теперь, когда вы знаете 4 области, определяющие сущность, вы добавите новые модели поведения к существующему мобу. В
этом примере вы добавите следующие модели поведения:

+ `minecraft:behavior.nearest_attackable_target`, чтобы определить, что корова может атаковать.
+ `minecraft:behavior.meleeattack`, чтобы дать каждой корове возможность наносить урон своей цели.
+ `minecraft:attack`, чтобы определить, сколько урона наносит каждая атака.

### minecraft:behavior.nearest_attackable_target

Для того чтобы корова могла атаковать, ей нужно найти цель, которую можно атаковать. В этом примере вы установите фильтр
на поиск `player`, чтобы сделать корову враждебным мобом и атаковать любого игрока.

``` json
"minecraft:behavior.nearest_attackable_target":{
    "priority": 2,
    "must_see": true,
    "reselect_targets": true,
    "within_radius": 25.0,
    "entity_types": [
    {
      "filters":{
           "test": "is_family", "subject": "other", "value": "player"
        },
    "max_dist":32
    }
  ]
},
```

В приведенном примере `nearest_attackable_target` - это компонент, который обрабатывает поведение для обнаружения
потенциальной цели. Компонент имеет следующие флаги:

+ `priority` - насколько важен этот компонент по сравнению с другими поведениями. Меньшие числа означают более высокий
  приоритет, то есть компонент с приоритетом 1 будет действовать раньше, чем другой компонент с приоритетом 4.
+ `reselect_targets` - булево значение, которое позволяет объекту повторно нацеливаться на тот же объект после атаки.
+ `within_radius` определяет радиус вокруг коровы, в котором могут быть выбраны цели.
+ `entity_types` - это набор аргументов, определяющих, какой тип объекта считается целью.
+ `filters` - тип объекта, который будет искать корова.
+ `max_dist` - расстояние в блоках между коровой и потенциальной целью в фильтре.
+ `must_see` - булево значение, определяющее, должна ли корова видеть цель. Корова должна смотреть прямо на игрока,
  чтобы считать его целью.

### minecraft:behavior.melee_attack

Как только корова обнаружит цель, следующим шагом будет разрешение атаки с помощью
компонента `minecraft:behavior.melee_attack`.

``` json
"minecraft:behavior.melee_attack": {
        "priority": 3
      },
```

### minecraft:attack

Теперь, когда корова может искать цель и атаковать, вам нужно добавить значение для нанесения урона при каждой атаке.

``` json
"minecraft:attack": {
        "damage": 3
      },
```

В приведенном выше фрагменте видно, что компонент имеет единственный аргумент. `"damage"` установлен на значение `3`,
что означает, что каждая атака будет отнимать 1,5 сердца от полоски жизни игрока.

#### Добавление параметров

Теперь, когда вы знаете каждое поведение, необходимое для того, чтобы корова напала на игрока, вы добавите эти поведения
в файл cow.json в папке `HelloWorldBP/entities`.

1. Скопируйте следующий код:
   ``` json
   "minecraft:behavior.nearest_attackable_target":{
     "priority": 2,
     "must_see":true,
     "reselect_targets": true,
     "within_radius": 25.0,
     "entity_types":[
       {
         "filters":{
           "test": "is_family", "subject": "other", "value": "player"
         },
         "max_dist":32
       }
     ]
   },
   "minecraft:behavior.melee_attack": {
     "priority": 3
   },
   "minecraft:attack":{
     "damage": 3
   }
   ```
2. Перейдите к контейнеру `components` в файле cow.json.
3. Ниже поведения `minecraft:conditional_bandwidth_optimization`, после запятой, завершающей поведение, нажмите Enter,
   чтобы добавить новую строку.
4. Вставьте код в новую строку.
    * Если после `minecraft:attack` есть другое поведение, добавьте запятую после закрывающей скобки.
5. Сохраните файл cow.json.

> Важно!
>
> Запятые используются для разделения каждого поведения в разделе `components`. При добавлении новых моделей поведения не забывайте ставить запятые, когда это необходимо.

Ниже показана готовая секция компонента с добавленным параметром.

``` json
"components": {
  "minecraft:type_family": {
    "family": [ "cow", "mob" ]
  },
  "minecraft:breathable": {
    "total_supply": 15,
    "suffocate_time": 0
  },
  "minecraft:navigation.walk": {
    "can_path_over_water": true,
    "avoid_water": true,
    "avoid_damage_blocks": true
  },
  "minecraft:movement.basic": {
  },
  "minecraft:jump.static": {
  },
  "minecraft:can_climb": {
  },
  "minecraft:collision_box": {
    "width": 0.9,
    "height": 1.3
  },
  "minecraft:nameable": {
  },
  "minecraft:health": {
    "value": 10,
    "max": 10
  },
  "minecraft:hurt_on_condition": {
    "damage_conditions": [
      {
        "filters": { "test": "in_lava", "subject": "self", "operator": "==", "value": true },
        "cause": "lava",
        "damage_per_tick": 4
      }
    ]
  },
  "minecraft:movement": {
    "value": 0.25
  },
  "minecraft:despawn": {
    "despawn_from_distance": {}
  },
  "minecraft:behavior.float": {
    "priority": 0
  },
  "minecraft:behavior.panic": {
    "priority": 1,
    "speed_multiplier": 1.25
  },
  "minecraft:behavior.mount_pathing": {
    "priority": 2,
    "speed_multiplier": 1.5,
    "target_dist": 0.0,
    "track_target": true
  },
  "minecraft:behavior.breed": {
    "priority": 3,
    "speed_multiplier": 1.0
  },
  "minecraft:behavior.tempt": {
    "priority": 4,
    "speed_multiplier": 1.25,
    "items": [
      "wheat"
    ]
  },
  "minecraft:behavior.follow_parent": {
    "priority": 5,
    "speed_multiplier": 1.1
  },
  "minecraft:behavior.random_stroll": {
    "priority": 6,
    "speed_multiplier": 0.8
  },
  "minecraft:behavior.look_at_player": {
    "priority": 7,
    "look_distance": 6.0,
    "probability": 0.02
  },
  "minecraft:behavior.random_look_around": {
    "priority": 9
  },
  "minecraft:leashable": {
    "soft_distance": 4.0,
    "hard_distance": 6.0,
    "max_distance": 10.0
  },
  "minecraft:balloonable": {
  },
  "minecraft:rideable": {
    "seat_count": 1,
    "family_types": [
      "zombie"
    ],
    "seats": {
      "position": [ 0.0, 1.105, 0.0 ]
    }
  },
  "minecraft:physics": {
  },
  "minecraft:pushable": {
    "is_pushable": true,
    "is_pushable_by_piston": true
  },
  "minecraft:conditional_bandwidth_optimization": {
  },
  "minecraft:behavior.nearest_attackable_target":{
    "priority": 2,
    "must_see":true,
    "reselect_targets": true,
    "within_radius": 25.0,
    "entity_types":[
      {
        "filters":{
          "test": "is_family", "subject": "other", "value": "player"
        },
        "max_dist":32
      }
    ]
  },
  "minecraft:behavior.melee_attack": {
    "priority": 3
  },
  "minecraft:attack":{
    "damage": 3
  }
},
```

### Тестирование пакета

Теперь, когда у пакета есть файл манифеста и модификация для коровы, вы можете запустить Minecraft и протестировать ваше
новое дополнение. Как указано во Введении в наборы ресурсов, **Наложение Пакетов** будет работать и для Наборов
Параметров. Это означает, что при загрузке контента сначала загружается ванильный контент, а затем все дополнительные
дополнения. Поскольку корова использует пространство имен cow.json, каждая корова унаследует новые модели поведения.

1. Запуск **Minecraft**.
2. Когда Minecraft запустится и откроется главное меню, выберите **Играть**.
3. Выберите **Создать новый мир**.
4. В разделе **Настройки** прокрутите вниз до раздела **Дополнения**.
5. Нажмите на **Наборы параметров**, чтобы увидеть все доступные пакеты.
6. Под всеми пакетами выберите **HelloWorldBP**, чтобы добавить пакет в мир.
7. Запустите свой мир.

### Что дальше?

Теперь, когда вы узнали, как дополнить существующие функции Minecraft, такие как текстуры и поведение, рекомендуется
узнать, как добавить новые элементы в Minecraft, начиная с компонента пользовательского блока.

[Как добавить пользовательский блок](Adding_a_Custom_Block.md)
